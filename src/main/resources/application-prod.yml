spring:
  config:
    activate:
      on-profile: prod
  application:
    name: "chingoo-haja"
  datasource:
    url: ${MYSQL_URL}
    username: ${MYSQL_USERNAME}
    password: ${MYSQL_PASSWORD}
    driver-class-name: com.mysql.cj.jdbc.Driver
  jpa:
    hibernate:
      ddl-auto: validate # 운영에서는 절대 스키마 변경 안함
    defer-datasource-initialization: false
    show-sql: false
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.MySQLDialect
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
      password: ${REDIS_PASSWORD}
      ssl:
        enabled: true
      timeout: 10000ms  # 10초
      connect-timeout: 10000ms  # 10초
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 2
          max-wait: 5000ms
        shutdown-timeout: 2000ms
  sql:
    init:
      mode: never
      data-locations: classpath:sql/category.sql
      continue-on-error: true

# 운영 환경 JWT 설정
app:
  jwt:
    secret: ${JWT_SECRET}
    access-token-expiration: 3600000  # 1시간
    refresh-token-expiration: 2592000000  # 30일
  oauth:
    kakao:
      client-id: ${KAKAO_CLIENT_ID}
      client-secret: ${KAKAO_CLIENT_SECRET}
      redirect-uri: "https://chingoohaja.app/oauth/callback"
    google:
      client-id: ${GOOGLE_CLIENT_ID}
      client-secret: ${GOOGLE_CLIENT_SECRET}
      redirect-uri: "https://chingoohaja.app/oauth/callback"
  cors:
    allowed-origins:
      - https://chingoo-frontend.vercel.app
      - https://www.chingoo-frontend.vercel.app
      - https://chingoohaja.app
      - https://www.chingoohaja.app
      - http://localhost:3000
  cookie:
    secure: true # HTTPS 필수
    same-site: None # 더 엄격한 보안
    max-age: 2592000 # 30일
  matching:
    scheduler:
      enabled: true
      matching-delay: 5000      # 5초 - 빠른 매칭
      cleanup-delay: 60000      # 1분 - 자주 정리
      expired-time: 600         # 10분
      log-level: WARN           # 중요한 로그만
      manual-trigger-enabled: false  # 보안상 비활성화

logging:
  level:
    root: INFO
    com.ldsilver.chingoohaja: INFO
    io.lettuce.core: INFO  # ✅ Redis 로그 디버깅